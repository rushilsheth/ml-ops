Based on this great lab: https://github.com/mlip-cmu/s2025/blob/main/labs/lab09.md